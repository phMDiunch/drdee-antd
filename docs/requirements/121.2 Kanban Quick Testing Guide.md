# Kanban Quick Testing Guide

## ğŸš€ Quick Start (5 minutes)

### 1. Access Kanban View

1. Navigate to: http://localhost:3000/sales-pipeline
2. Click tab **"Kanban View"** (third tab)
3. Should see 6 columns: Äáº¿n â†’ TÆ° váº¥n â†’ BÃ¡o giÃ¡ â†’ Äáº·t cá»c â†’ Äang Ä‘iá»u trá»‹ â†’ Tháº¥t báº¡i

### 2. Test Drag & Drop (Basic)

**Scenario**: Move deal from ARRIVED to CONSULTING

1. Find a card in "Äáº¿n" column
2. Drag it to "TÆ° váº¥n" column
3. **Expected**: Modal appears with title "XÃ¡c nháº­n chuyá»ƒn giai Ä‘oáº¡n"
4. **Expected**: Shows "Äáº¿n â†’ TÆ° váº¥n" with icons
5. Enter note (optional): "KhÃ¡ch hÃ ng Ä‘á»“ng Ã½ tÆ° váº¥n"
6. Click **"XÃ¡c nháº­n"**
7. **Expected**: Success message "ÄÃ£ chuyá»ƒn sang TÆ° váº¥n"
8. **Expected**: Card moves to "TÆ° váº¥n" column

âœ… **Pass**: Card moved successfully  
âŒ **Fail**: Error message or card stays in place

---

### 3. Test LOST Stage (Critical)

**Scenario**: Move deal to LOST stage requires reason

1. Drag any card to "Tháº¥t báº¡i" column (red)
2. **Expected**: Modal appears with red warning box
3. **Expected**: "LÃ½ do tháº¥t báº¡i" field is required (red asterisk)
4. Try clicking "XÃ¡c nháº­n" without entering reason
5. **Expected**: Validation error "Vui lÃ²ng nháº­p lÃ½ do tháº¥t báº¡i"
6. Enter short text (e.g., "test")
7. **Expected**: Error "LÃ½ do pháº£i cÃ³ Ã­t nháº¥t 5 kÃ½ tá»±"
8. Enter valid reason: "KhÃ¡ch hÃ ng chá»n phÃ²ng khÃ¡m khÃ¡c vÃ¬ giÃ¡ ráº» hÆ¡n"
9. Click **"XÃ¡c nháº­n"**
10. **Expected**: Success message, card moves to "Tháº¥t báº¡i"

âœ… **Pass**: Cannot submit without valid reason (5-500 chars)  
âŒ **Fail**: Allows empty reason or shows wrong validation

---

### 4. Test Invalid Transitions

**Scenario**: Cannot skip stages or drag from terminal

1. Try dragging from "Äáº¿n" directly to "Äáº·t cá»c"
2. **Expected**: Red tooltip "KhÃ´ng thá»ƒ chuyá»ƒn tá»« Äáº¿n sang Äáº·t cá»c"
3. Try dragging from "Äang Ä‘iá»u trá»‹"
4. **Expected**: Red tooltip "KhÃ´ng thá»ƒ di chuyá»ƒn tá»« giai Ä‘oáº¡n cuá»‘i"
5. Try dragging from "Tháº¥t báº¡i"
6. **Expected**: Red tooltip "KhÃ´ng thá»ƒ di chuyá»ƒn tá»« giai Ä‘oáº¡n cuá»‘i"

âœ… **Pass**: All invalid transitions blocked  
âŒ **Fail**: Allows invalid drag or shows no warning

---

### 5. Test Priority Badges

**Scenario**: Cards show HIGH/MEDIUM priority based on contact date

**Test Data Needed**: Create test deals with:

- Deal A: No contact for 8+ days
- Deal B: No contact for 4-5 days
- Deal C: Contact today

**Expected Results**:

- Deal A: Red "HIGH" badge with ğŸ”¥ fire icon
- Deal B: Orange "MEDIUM" badge
- Deal C: No badge (LOW priority)

âœ… **Pass**: Correct badges show based on contact date  
âŒ **Fail**: Wrong badge colors or missing badges

**Quick Hack** (if no test data):

```sql
-- In database, update a deal's last activity log
UPDATE "SalesActivityLog"
SET "contactDate" = NOW() - INTERVAL '10 days'
WHERE "consultedServiceId" = 'your-deal-id';

-- Refresh Kanban view to see HIGH badge
```

---

### 6. Test Load More

**Scenario**: Pagination works per column

**Test Data Needed**: 25+ deals in one stage

1. If column shows "Xem thÃªm (5/25)" button at bottom
2. Click **"Xem thÃªm"**
3. **Expected**: Shows loading spinner
4. **Expected**: More cards appear (next 20)
5. **Expected**: Count updates "Xem thÃªm (25/25)"
6. **Expected**: Button disappears when all loaded

âœ… **Pass**: Pagination loads correctly per column  
âŒ **Fail**: Button doesn't work or loads wrong data

**Quick Hack** (if <20 deals):
Skip this test or duplicate deals in database for testing.

---

### 7. Test Responsive Design

**Scenario**: Layout adapts to screen size

1. **Desktop** (>1024px): Should see all 6 columns side by side
2. **Tablet** (768-1024px): Resize browser, should see 2-3 columns with horizontal scroll
3. **Mobile** (<480px): Should see 1 column, swipe to scroll

âœ… **Pass**: Layout adapts smoothly  
âŒ **Fail**: Columns overlap or break layout

---

### 8. Test Empty State

**Scenario**: Empty columns show placeholder

1. Find a stage with no deals (e.g., new clinic)
2. **Expected**: Shows "ChÆ°a cÃ³ dá»¯ liá»‡u" with icon
3. Try dragging card to empty column
4. **Expected**: Works normally, empty message disappears

âœ… **Pass**: Empty state shows and drag works  
âŒ **Fail**: Blank column or drag error

---

## ğŸ”¥ Critical Tests (Must Pass)

### Priority 1: LOST Stage Validation

- [ ] Cannot submit LOST without reason
- [ ] Reason must be 5-500 characters
- [ ] Warning shows about terminal state
- [ ] StageHistory record created in database

### Priority 2: Drag Validation

- [ ] Cannot drag from TREATING
- [ ] Cannot drag from LOST
- [ ] Cannot skip stages (e.g., ARRIVED â†’ DEPOSIT)
- [ ] Tooltips show clear error messages

### Priority 3: Data Integrity

- [ ] Stage updates in database after drag
- [ ] Query refetches after mutation
- [ ] No duplicate cards after drag
- [ ] No lost cards after error

---

## ğŸ› Bug Reporting Template

If you find a bug, report with:

```markdown
**Bug**: [Short description]

**Steps to Reproduce**:

1. Go to /sales-pipeline
2. Click "Kanban View"
3. Drag card from X to Y
4. Enter reason "..."
5. Click confirm

**Expected**: [What should happen]
**Actual**: [What actually happened]

**Environment**:

- Browser: Chrome 120
- OS: Windows 11
- Screen size: 1920x1080

**Screenshot**: [Attach if possible]

**Console Errors**: [Check DevTools Console tab]
```

---

## âš¡ Performance Checklist

Test with large dataset (100+ deals):

- [ ] Initial load <2 seconds
- [ ] Drag start <16ms (smooth 60fps)
- [ ] Drop animation smooth
- [ ] Load More <1 second
- [ ] No memory leaks (check DevTools Memory tab)
- [ ] No layout shifts during drag

---

## ğŸ¯ Acceptance Criteria

**Pass if ALL critical tests pass + no major bugs**

Minimum requirements:
âœ… Drag & drop works for valid transitions  
âœ… LOST stage requires valid reason  
âœ… Invalid transitions blocked with clear messages  
âœ… Data persists to database correctly  
âœ… UI is responsive on mobile/tablet/desktop

**Ready for Production if ALL tests pass + performance OK**

---

## ğŸ“ Support

**Issues?**

1. Check browser console for errors
2. Check network tab for failed API calls
3. Check database for StageHistory records
4. Review Implementation Summary (121.1 Kanban Implementation Summary.md)

**Common Fixes**:

- Clear browser cache
- Restart dev server
- Check database connection
- Verify .env variables

---

_Testing Time: ~30 minutes (full suite)_  
_Critical Tests Only: ~10 minutes_  
_Version: 1.0.0_
